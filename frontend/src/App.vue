<script setup>
import { onMounted, onUnmounted, watch, ref, watchEffect } from "vue";
import moment from "moment";
import StatComponent from "./components/StatComponent.vue";
import Cookies from "js-cookie"


const api_url = `https://weather-station-api.jacksalici.workers.dev/`;


var daily_query = {
   "code":0,
   "msg":"success",
   "time":"1684187731",
   "data":{
      "outdoor":{
         "temperature":{
            "unit":"℃",
            "list":{
               "1672531200":"9.3",
               "1672533000":"9.3",
               "1672534800":"9.2",
               "1672536600":"9.1",
               "1672538400":"9.1",
               "1672540200":"9.1",
               "1672542000":"9.0",
               "1672543800":"9.0",
               "1672545600":"8.8",
               "1672547400":"8.8",
               "1672549200":"8.8",
               "1672551000":"8.7",
               "1672552800":"8.7",
               "1672554600":"8.6",
               "1672556400":"8.5",
               "1672558200":"8.9",
               "1672560000":"9.4",
               "1672561800":"9.6",
               "1672563600":"9.9",
               "1672565400":"10.5",
               "1672567200":"10.6",
               "1672569000":"10.8",
               "1672570800":"10.7",
               "1672572600":"10.8",
               "1672574400":"10.8",
               "1672576200":"11.0",
               "1672578000":"10.9",
               "1672579800":"10.8",
               "1672581600":"10.7",
               "1672583400":"10.6",
               "1672585200":"10.5",
               "1672587000":"10.3",
               "1672588800":"9.9",
               "1672590600":"9.5",
               "1672592400":"9.5",
               "1672594200":"9.3",
               "1672596000":"8.8",
               "1672597800":"8.4",
               "1672599600":"8.3",
               "1672601400":"8.1",
               "1672603200":"7.8",
               "1672605000":"7.6",
               "1672606800":"7.8",
               "1672608600":"8.3",
               "1672610400":"8.4",
               "1672612200":"8.6",
               "1672527600":"9.5",
               "1672529400":"9.5"
            }
         },
         "feels_like":{
            "unit":"℃",
            "list":{
               "1672531200":"9.3",
               "1672533000":"9.3",
               "1672534800":"9.2",
               "1672536600":"9.1",
               "1672538400":"9.1",
               "1672540200":"9.1",
               "1672542000":"9.0",
               "1672543800":"9.0",
               "1672545600":"8.8",
               "1672547400":"8.8",
               "1672549200":"8.8",
               "1672551000":"8.7",
               "1672552800":"8.7",
               "1672554600":"8.6",
               "1672556400":"8.5",
               "1672558200":"8.9",
               "1672560000":"9.4",
               "1672561800":"9.6",
               "1672563600":"9.9",
               "1672565400":"10.5",
               "1672567200":"10.6",
               "1672569000":"10.8",
               "1672570800":"10.7",
               "1672572600":"10.8",
               "1672574400":"10.8",
               "1672576200":"10.9",
               "1672578000":"10.8",
               "1672579800":"10.8",
               "1672581600":"10.7",
               "1672583400":"10.6",
               "1672585200":"10.5",
               "1672587000":"10.3",
               "1672588800":"9.9",
               "1672590600":"9.5",
               "1672592400":"9.5",
               "1672594200":"9.3",
               "1672596000":"8.8",
               "1672597800":"8.4",
               "1672599600":"8.3",
               "1672601400":"8.1",
               "1672603200":"7.8",
               "1672605000":"7.6",
               "1672606800":"7.8",
               "1672608600":"8.3",
               "1672610400":"8.4",
               "1672612200":"8.6",
               "1672527600":"9.5",
               "1672529400":"9.5"
            }
         },
         "app_temp":{
            "unit":"℃",
            "list":{
               "1672531200":"9.0",
               "1672533000":"8.9",
               "1672534800":"8.8",
               "1672536600":"8.7",
               "1672538400":"8.7",
               "1672540200":"8.6",
               "1672542000":"8.6",
               "1672543800":"8.5",
               "1672545600":"8.4",
               "1672547400":"8.2",
               "1672549200":"8.3",
               "1672551000":"8.3",
               "1672552800":"8.3",
               "1672554600":"8.2",
               "1672556400":"8.0",
               "1672558200":"8.4",
               "1672560000":"9.0",
               "1672561800":"9.2",
               "1672563600":"9.6",
               "1672565400":"10.2",
               "1672567200":"10.4",
               "1672569000":"10.6",
               "1672570800":"10.4",
               "1672572600":"10.6",
               "1672574400":"10.5",
               "1672576200":"10.8",
               "1672578000":"10.7",
               "1672579800":"10.6",
               "1672581600":"10.5",
               "1672583400":"10.5",
               "1672585200":"10.3",
               "1672587000":"10.1",
               "1672588800":"9.7",
               "1672590600":"9.3",
               "1672592400":"9.3",
               "1672594200":"9.1",
               "1672596000":"8.5",
               "1672597800":"8.1",
               "1672599600":"7.9",
               "1672601400":"7.6",
               "1672603200":"7.3",
               "1672605000":"7.0",
               "1672606800":"7.2",
               "1672608600":"7.8",
               "1672610400":"8.0",
               "1672612200":"8.2",
               "1672527600":"9.1",
               "1672529400":"9.1"
            }
         },
         "dew_point":{
            "unit":"℃",
            "list":{
               "1672531200":"8.4",
               "1672533000":"8.4",
               "1672534800":"8.3",
               "1672536600":"8.2",
               "1672538400":"8.2",
               "1672540200":"8.2",
               "1672542000":"8.2",
               "1672543800":"8.1",
               "1672545600":"8.1",
               "1672547400":"8.0",
               "1672549200":"8.1",
               "1672551000":"8.1",
               "1672552800":"8.1",
               "1672554600":"8.1",
               "1672556400":"8.0",
               "1672558200":"8.2",
               "1672560000":"8.6",
               "1672561800":"8.6",
               "1672563600":"8.8",
               "1672565400":"9.1",
               "1672567200":"9.2",
               "1672569000":"9.3",
               "1672570800":"9.2",
               "1672572600":"9.3",
               "1672574400":"9.3",
               "1672576200":"9.4",
               "1672578000":"9.4",
               "1672579800":"9.3",
               "1672581600":"9.3",
               "1672583400":"9.3",
               "1672585200":"9.3",
               "1672587000":"9.3",
               "1672588800":"9.1",
               "1672590600":"8.9",
               "1672592400":"8.9",
               "1672594200":"8.8",
               "1672596000":"8.5",
               "1672597800":"8.3",
               "1672599600":"8.2",
               "1672601400":"7.9",
               "1672603200":"7.7",
               "1672605000":"7.4",
               "1672606800":"7.7",
               "1672608600":"8.1",
               "1672610400":"8.3",
               "1672612200":"8.4",
               "1672527600":"8.5",
               "1672529400":"8.6"
            }
         },
         "humidity":{
            "unit":"%",
            "list":{
               "1672531200":"94",
               "1672533000":"94",
               "1672534800":"94",
               "1672536600":"94",
               "1672538400":"94",
               "1672540200":"94",
               "1672542000":"94",
               "1672543800":"95",
               "1672545600":"95",
               "1672547400":"95",
               "1672549200":"95",
               "1672551000":"96",
               "1672552800":"96",
               "1672554600":"97",
               "1672556400":"97",
               "1672558200":"96",
               "1672560000":"94",
               "1672561800":"94",
               "1672563600":"92",
               "1672565400":"91",
               "1672567200":"91",
               "1672569000":"90",
               "1672570800":"90",
               "1672572600":"90",
               "1672574400":"91",
               "1672576200":"90",
               "1672578000":"91",
               "1672579800":"91",
               "1672581600":"91",
               "1672583400":"92",
               "1672585200":"92",
               "1672587000":"94",
               "1672588800":"95",
               "1672590600":"96",
               "1672592400":"96",
               "1672594200":"96",
               "1672596000":"98",
               "1672597800":"99",
               "1672599600":"99",
               "1672601400":"99",
               "1672603200":"99",
               "1672605000":"99",
               "1672606800":"99",
               "1672608600":"99",
               "1672610400":"99",
               "1672612200":"99",
               "1672527600":"93",
               "1672529400":"94"
            }
         }
      },
      "indoor":{
         "temperature":{
            "unit":"℃",
            "list":{
               "1672531200":"19.9",
               "1672533000":"19.7",
               "1672534800":"19.6",
               "1672536600":"19.5",
               "1672538400":"19.4",
               "1672540200":"19.3",
               "1672542000":"19.3",
               "1672543800":"19.2",
               "1672545600":"19.2",
               "1672547400":"19.1",
               "1672549200":"19.1",
               "1672551000":"19.0",
               "1672552800":"19.0",
               "1672554600":"18.9",
               "1672556400":"17.7",
               "1672558200":"18.2",
               "1672560000":"19.1",
               "1672561800":"19.4",
               "1672563600":"19.8",
               "1672565400":"20.0",
               "1672567200":"20.0",
               "1672569000":"19.8",
               "1672570800":"19.7",
               "1672572600":"19.6",
               "1672574400":"19.6",
               "1672576200":"20.0",
               "1672578000":"20.5",
               "1672579800":"20.6",
               "1672581600":"20.8",
               "1672583400":"20.7",
               "1672585200":"20.2",
               "1672587000":"20.4",
               "1672588800":"20.5",
               "1672590600":"20.4",
               "1672592400":"20.4",
               "1672594200":"20.4",
               "1672596000":"20.3",
               "1672597800":"20.2",
               "1672599600":"20.3",
               "1672601400":"20.5",
               "1672603200":"20.3",
               "1672605000":"20.2",
               "1672606800":"20.0",
               "1672608600":"20.1",
               "1672610400":"20.2",
               "1672612200":"20.2",
               "1672527600":"19.7",
               "1672529400":"19.9"
            }
         },
         "humidity":{
            "unit":"%",
            "list":{
               "1672531200":"67",
               "1672533000":"67",
               "1672534800":"67",
               "1672536600":"67",
               "1672538400":"67",
               "1672540200":"67",
               "1672542000":"66",
               "1672543800":"66",
               "1672545600":"66",
               "1672547400":"66",
               "1672549200":"66",
               "1672551000":"66",
               "1672552800":"66",
               "1672554600":"66",
               "1672556400":"65",
               "1672558200":"61",
               "1672560000":"61",
               "1672561800":"62",
               "1672563600":"62",
               "1672565400":"63",
               "1672567200":"63",
               "1672569000":"63",
               "1672570800":"64",
               "1672572600":"65",
               "1672574400":"65",
               "1672576200":"65",
               "1672578000":"65",
               "1672579800":"65",
               "1672581600":"65",
               "1672583400":"65",
               "1672585200":"61",
               "1672587000":"63",
               "1672588800":"64",
               "1672590600":"64",
               "1672592400":"64",
               "1672594200":"64",
               "1672596000":"64",
               "1672597800":"65",
               "1672599600":"65",
               "1672601400":"65",
               "1672603200":"66",
               "1672605000":"66",
               "1672606800":"67",
               "1672608600":"67",
               "1672610400":"67",
               "1672612200":"67",
               "1672527600":"66",
               "1672529400":"67"
            }
         }
      },
      "solar_and_uvi":{
         "solar":{
            "unit":"W\/m²",
            "list":{
               "1672531200":"0.0",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"0.0",
               "1672540200":"0.0",
               "1672542000":"0.0",
               "1672543800":"0.0",
               "1672545600":"0.0",
               "1672547400":"0.0",
               "1672549200":"0.0",
               "1672551000":"0.0",
               "1672552800":"0.1",
               "1672554600":"4.5",
               "1672556400":"29.7",
               "1672558200":"62.6",
               "1672560000":"49.0",
               "1672561800":"76.8",
               "1672563600":"100.9",
               "1672565400":"125.9",
               "1672567200":"111.9",
               "1672569000":"114.7",
               "1672570800":"102.4",
               "1672572600":"88.5",
               "1672574400":"82.4",
               "1672576200":"78.5",
               "1672578000":"40.1",
               "1672579800":"43.5",
               "1672581600":"29.3",
               "1672583400":"20.6",
               "1672585200":"11.1",
               "1672587000":"2.9",
               "1672588800":"0.2",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"0.0"
            }
         },
         "uvi":{
            "unit":"",
            "list":{
               "1672531200":"0",
               "1672533000":"0",
               "1672534800":"0",
               "1672536600":"0",
               "1672538400":"0",
               "1672540200":"0",
               "1672542000":"0",
               "1672543800":"0",
               "1672545600":"0",
               "1672547400":"0",
               "1672549200":"0",
               "1672551000":"0",
               "1672552800":"0",
               "1672554600":"0",
               "1672556400":"0",
               "1672558200":"0",
               "1672560000":"0",
               "1672561800":"0",
               "1672563600":"0",
               "1672565400":"1",
               "1672567200":"1",
               "1672569000":"1",
               "1672570800":"0",
               "1672572600":"0",
               "1672574400":"0",
               "1672576200":"0",
               "1672578000":"0",
               "1672579800":"0",
               "1672581600":"0",
               "1672583400":"0",
               "1672585200":"0",
               "1672587000":"0",
               "1672588800":"0",
               "1672590600":"0",
               "1672592400":"0",
               "1672594200":"0",
               "1672596000":"0",
               "1672597800":"0",
               "1672599600":"0",
               "1672601400":"0",
               "1672603200":"0",
               "1672605000":"0",
               "1672606800":"0",
               "1672608600":"0",
               "1672610400":"0",
               "1672612200":"0",
               "1672527600":"0",
               "1672529400":"0"
            }
         }
      },
      "rainfall":{
         "rain_rate":{
            "unit":"mm\/hr",
            "list":{
               "1672531200":"0.0",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"0.0",
               "1672540200":"0.0",
               "1672542000":"0.0",
               "1672543800":"0.0",
               "1672545600":"0.0",
               "1672547400":"0.0",
               "1672549200":"0.0",
               "1672551000":"0.0",
               "1672552800":"0.0",
               "1672554600":"0.0",
               "1672556400":"0.0",
               "1672558200":"0.0",
               "1672560000":"0.0",
               "1672561800":"0.0",
               "1672563600":"0.0",
               "1672565400":"0.0",
               "1672567200":"0.0",
               "1672569000":"0.0",
               "1672570800":"0.0",
               "1672572600":"0.0",
               "1672574400":"0.0",
               "1672576200":"0.0",
               "1672578000":"0.0",
               "1672579800":"0.0",
               "1672581600":"0.0",
               "1672583400":"0.0",
               "1672585200":"0.0",
               "1672587000":"0.0",
               "1672588800":"0.0",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"0.0"
            }
         },
         "daily":{
            "unit":"mm",
            "list":{
               "1672531200":"0.0",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"0.0",
               "1672540200":"0.0",
               "1672542000":"0.0",
               "1672543800":"0.0",
               "1672545600":"0.0",
               "1672547400":"0.0",
               "1672549200":"0.0",
               "1672551000":"0.0",
               "1672552800":"0.0",
               "1672554600":"0.0",
               "1672556400":"0.0",
               "1672558200":"0.0",
               "1672560000":"0.0",
               "1672561800":"0.0",
               "1672563600":"0.0",
               "1672565400":"0.0",
               "1672567200":"0.0",
               "1672569000":"0.0",
               "1672570800":"0.0",
               "1672572600":"0.0",
               "1672574400":"0.0",
               "1672576200":"0.0",
               "1672578000":"0.0",
               "1672579800":"0.0",
               "1672581600":"0.0",
               "1672583400":"0.0",
               "1672585200":"0.0",
               "1672587000":"0.0",
               "1672588800":"0.0",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"0.0"
            }
         },
         "event":{
            "unit":"mm",
            "list":{
               "1672531200":"0.0",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"0.0",
               "1672540200":"0.0",
               "1672542000":"0.0",
               "1672543800":"0.0",
               "1672545600":"0.0",
               "1672547400":"0.0",
               "1672549200":"0.0",
               "1672551000":"0.0",
               "1672552800":"0.0",
               "1672554600":"0.0",
               "1672556400":"0.0",
               "1672558200":"0.0",
               "1672560000":"0.0",
               "1672561800":"0.0",
               "1672563600":"0.0",
               "1672565400":"0.0",
               "1672567200":"0.0",
               "1672569000":"0.0",
               "1672570800":"0.0",
               "1672572600":"0.0",
               "1672574400":"0.0",
               "1672576200":"0.0",
               "1672578000":"0.0",
               "1672579800":"0.0",
               "1672581600":"0.0",
               "1672583400":"0.0",
               "1672585200":"0.0",
               "1672587000":"0.0",
               "1672588800":"0.0",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"0.0"
            }
         },
         "hourly":{
            "unit":"mm",
            "list":{
               "1672531200":"0.0",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"0.0",
               "1672540200":"0.0",
               "1672542000":"0.0",
               "1672543800":"0.0",
               "1672545600":"0.0",
               "1672547400":"0.0",
               "1672549200":"0.0",
               "1672551000":"0.0",
               "1672552800":"0.0",
               "1672554600":"0.0",
               "1672556400":"0.0",
               "1672558200":"0.0",
               "1672560000":"0.0",
               "1672561800":"0.0",
               "1672563600":"0.0",
               "1672565400":"0.0",
               "1672567200":"0.0",
               "1672569000":"0.0",
               "1672570800":"0.0",
               "1672572600":"0.0",
               "1672574400":"0.0",
               "1672576200":"0.0",
               "1672578000":"0.0",
               "1672579800":"0.0",
               "1672581600":"0.0",
               "1672583400":"0.0",
               "1672585200":"0.0",
               "1672587000":"0.0",
               "1672588800":"0.0",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"0.0"
            }
         },
         "weekly":{
            "unit":"mm",
            "list":{
               "1672531200":"7.9",
               "1672533000":"7.9",
               "1672534800":"7.9",
               "1672536600":"7.9",
               "1672538400":"7.9",
               "1672540200":"7.9",
               "1672542000":"7.9",
               "1672543800":"7.9",
               "1672545600":"7.9",
               "1672547400":"7.9",
               "1672549200":"7.9",
               "1672551000":"7.9",
               "1672552800":"7.9",
               "1672554600":"7.9",
               "1672556400":"7.9",
               "1672558200":"7.9",
               "1672560000":"7.9",
               "1672561800":"7.9",
               "1672563600":"7.9",
               "1672565400":"7.9",
               "1672567200":"7.9",
               "1672569000":"7.9",
               "1672570800":"7.9",
               "1672572600":"7.9",
               "1672574400":"7.9",
               "1672576200":"7.9",
               "1672578000":"7.9",
               "1672579800":"7.9",
               "1672581600":"7.9",
               "1672583400":"7.9",
               "1672585200":"7.9",
               "1672587000":"7.9",
               "1672588800":"7.9",
               "1672590600":"7.9",
               "1672592400":"7.9",
               "1672594200":"7.9",
               "1672596000":"7.9",
               "1672597800":"7.9",
               "1672599600":"7.9",
               "1672601400":"7.9",
               "1672603200":"7.9",
               "1672605000":"7.9",
               "1672606800":"7.9",
               "1672608600":"7.9",
               "1672610400":"7.9",
               "1672612200":"7.9",
               "1672527600":"7.9",
               "1672529400":"7.9"
            }
         },
         "monthly":{
            "unit":"mm",
            "list":{
               "1672531200":"0.0",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"0.0",
               "1672540200":"0.0",
               "1672542000":"0.0",
               "1672543800":"0.0",
               "1672545600":"0.0",
               "1672547400":"0.0",
               "1672549200":"0.0",
               "1672551000":"0.0",
               "1672552800":"0.0",
               "1672554600":"0.0",
               "1672556400":"0.0",
               "1672558200":"0.0",
               "1672560000":"0.0",
               "1672561800":"0.0",
               "1672563600":"0.0",
               "1672565400":"0.0",
               "1672567200":"0.0",
               "1672569000":"0.0",
               "1672570800":"0.0",
               "1672572600":"0.0",
               "1672574400":"0.0",
               "1672576200":"0.0",
               "1672578000":"0.0",
               "1672579800":"0.0",
               "1672581600":"0.0",
               "1672583400":"0.0",
               "1672585200":"0.0",
               "1672587000":"0.0",
               "1672588800":"0.0",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"0.0"
            }
         },
         "yearly":{
            "unit":"mm",
            "list":{
               "1672531200":"0.0",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"0.0",
               "1672540200":"0.0",
               "1672542000":"0.0",
               "1672543800":"0.0",
               "1672545600":"0.0",
               "1672547400":"0.0",
               "1672549200":"0.0",
               "1672551000":"0.0",
               "1672552800":"0.0",
               "1672554600":"0.0",
               "1672556400":"0.0",
               "1672558200":"0.0",
               "1672560000":"0.0",
               "1672561800":"0.0",
               "1672563600":"0.0",
               "1672565400":"0.0",
               "1672567200":"0.0",
               "1672569000":"0.0",
               "1672570800":"0.0",
               "1672572600":"0.0",
               "1672574400":"0.0",
               "1672576200":"0.0",
               "1672578000":"0.0",
               "1672579800":"0.0",
               "1672581600":"0.0",
               "1672583400":"0.0",
               "1672585200":"0.0",
               "1672587000":"0.0",
               "1672588800":"0.0",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"0.0"
            }
         }
      },
      "wind":{
         "wind_speed":{
            "unit":"km\/h",
            "list":{
               "1672531200":"0.0",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"0.0",
               "1672540200":"0.0",
               "1672542000":"0.0",
               "1672543800":"0.0",
               "1672545600":"0.1",
               "1672547400":"0.2",
               "1672549200":"0.0",
               "1672551000":"0.0",
               "1672552800":"0.1",
               "1672554600":"0.0",
               "1672556400":"0.0",
               "1672558200":"0.2",
               "1672560000":"0.3",
               "1672561800":"0.4",
               "1672563600":"0.4",
               "1672565400":"0.5",
               "1672567200":"0.4",
               "1672569000":"0.3",
               "1672570800":"0.4",
               "1672572600":"0.3",
               "1672574400":"1.0",
               "1672576200":"0.4",
               "1672578000":"0.1",
               "1672579800":"0.1",
               "1672581600":"0.0",
               "1672583400":"0.0",
               "1672585200":"0.0",
               "1672587000":"0.0",
               "1672588800":"0.0",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"0.0"
            }
         },
         "wind_gust":{
            "unit":"km\/h",
            "list":{
               "1672531200":"1.8",
               "1672533000":"0.0",
               "1672534800":"0.0",
               "1672536600":"0.0",
               "1672538400":"1.8",
               "1672540200":"1.8",
               "1672542000":"1.8",
               "1672543800":"1.8",
               "1672545600":"3.6",
               "1672547400":"5.4",
               "1672549200":"1.8",
               "1672551000":"1.8",
               "1672552800":"3.6",
               "1672554600":"0.0",
               "1672556400":"1.8",
               "1672558200":"5.4",
               "1672560000":"5.4",
               "1672561800":"7.2",
               "1672563600":"5.4",
               "1672565400":"5.4",
               "1672567200":"5.4",
               "1672569000":"5.4",
               "1672570800":"5.4",
               "1672572600":"3.6",
               "1672574400":"5.4",
               "1672576200":"3.6",
               "1672578000":"1.8",
               "1672579800":"3.6",
               "1672581600":"3.6",
               "1672583400":"1.8",
               "1672585200":"1.8",
               "1672587000":"1.8",
               "1672588800":"0.0",
               "1672590600":"0.0",
               "1672592400":"0.0",
               "1672594200":"0.0",
               "1672596000":"0.0",
               "1672597800":"0.0",
               "1672599600":"0.0",
               "1672601400":"0.0",
               "1672603200":"0.0",
               "1672605000":"0.0",
               "1672606800":"0.0",
               "1672608600":"0.0",
               "1672610400":"0.0",
               "1672612200":"0.0",
               "1672527600":"0.0",
               "1672529400":"1.8"
            }
         },
         "wind_direction":{
            "unit":"º",
            "list":{
               "1672531200":"335",
               "1672533000":"335",
               "1672534800":"335",
               "1672536600":"335",
               "1672538400":"335",
               "1672540200":"335",
               "1672542000":"334",
               "1672543800":"320",
               "1672545600":"289",
               "1672547400":"274",
               "1672549200":"272",
               "1672551000":"272",
               "1672552800":"279",
               "1672554600":"279",
               "1672556400":"279",
               "1672558200":"222",
               "1672560000":"212",
               "1672561800":"263",
               "1672563600":"333",
               "1672565400":"339",
               "1672567200":"306",
               "1672569000":"309",
               "1672570800":"307",
               "1672572600":"317",
               "1672574400":"300",
               "1672576200":"305",
               "1672578000":"319",
               "1672579800":"320",
               "1672581600":"314",
               "1672583400":"313",
               "1672585200":"287",
               "1672587000":"287",
               "1672588800":"287",
               "1672590600":"287",
               "1672592400":"287",
               "1672594200":"287",
               "1672596000":"287",
               "1672597800":"287",
               "1672599600":"287",
               "1672601400":"287",
               "1672603200":"287",
               "1672605000":"287",
               "1672606800":"287",
               "1672608600":"287",
               "1672610400":"287",
               "1672612200":"287",
               "1672527600":"335",
               "1672529400":"335"
            }
         }
      },
      "pressure":{
         "relative":{
            "unit":"mmHg",
            "list":{
               "1672531200":"773.1",
               "1672533000":"773.1",
               "1672534800":"773.0",
               "1672536600":"773.0",
               "1672538400":"772.9",
               "1672540200":"772.7",
               "1672542000":"772.7",
               "1672543800":"772.6",
               "1672545600":"772.4",
               "1672547400":"772.4",
               "1672549200":"772.6",
               "1672551000":"772.7",
               "1672552800":"772.7",
               "1672554600":"772.6",
               "1672556400":"772.7",
               "1672558200":"772.8",
               "1672560000":"773.0",
               "1672561800":"773.0",
               "1672563600":"773.1",
               "1672565400":"773.1",
               "1672567200":"773.0",
               "1672569000":"772.7",
               "1672570800":"772.5",
               "1672572600":"772.2",
               "1672574400":"772.1",
               "1672576200":"772.0",
               "1672578000":"772.0",
               "1672579800":"771.9",
               "1672581600":"772.0",
               "1672583400":"772.1",
               "1672585200":"772.1",
               "1672587000":"772.0",
               "1672588800":"772.2",
               "1672590600":"772.3",
               "1672592400":"772.3",
               "1672594200":"772.4",
               "1672596000":"772.5",
               "1672597800":"772.6",
               "1672599600":"772.6",
               "1672601400":"772.7",
               "1672603200":"772.6",
               "1672605000":"772.7",
               "1672606800":"772.7",
               "1672608600":"772.8",
               "1672610400":"772.8",
               "1672612200":"772.8",
               "1672527600":"773.2",
               "1672529400":"773.2"
            }
         },
         "absolute":{
            "unit":"mmHg",
            "list":{
               "1672531200":"773.1",
               "1672533000":"773.1",
               "1672534800":"773.0",
               "1672536600":"773.0",
               "1672538400":"772.9",
               "1672540200":"772.7",
               "1672542000":"772.7",
               "1672543800":"772.6",
               "1672545600":"772.4",
               "1672547400":"772.4",
               "1672549200":"772.6",
               "1672551000":"772.7",
               "1672552800":"772.7",
               "1672554600":"772.6",
               "1672556400":"772.7",
               "1672558200":"772.8",
               "1672560000":"773.0",
               "1672561800":"773.0",
               "1672563600":"773.1",
               "1672565400":"773.1",
               "1672567200":"773.0",
               "1672569000":"772.7",
               "1672570800":"772.5",
               "1672572600":"772.2",
               "1672574400":"772.1",
               "1672576200":"772.0",
               "1672578000":"772.0",
               "1672579800":"771.9",
               "1672581600":"772.0",
               "1672583400":"772.1",
               "1672585200":"772.1",
               "1672587000":"772.0",
               "1672588800":"772.2",
               "1672590600":"772.3",
               "1672592400":"772.3",
               "1672594200":"772.4",
               "1672596000":"772.5",
               "1672597800":"772.6",
               "1672599600":"772.6",
               "1672601400":"772.7",
               "1672603200":"772.6",
               "1672605000":"772.7",
               "1672606800":"772.7",
               "1672608600":"772.8",
               "1672610400":"772.8",
               "1672612200":"772.8",
               "1672527600":"773.2",
               "1672529400":"773.2"
            }
         }
      }
   }
}


var istant_query = ref({
  code: 0,
  msg: "success",
  time: "0",
  data: {
    outdoor: {
      temperature: { time: " ", unit: " ", value: "0" },
      feels_like: { time: " ", unit: " ", value: "0" },
      app_temp: { time: " ", unit: " ", value: "0" },
      dew_point: { time: " ", unit: " ", value: "0" },
      humidity: { time: " ", unit: " ", value: "0" },
    },
    indoor: {
      temperature: { time: " ", unit: " ", value: "0" },
      humidity: { time: " ", unit: " ", value: "0" },
    },
    solar_and_uvi: {
      solar: { time: " ", unit: " ", value: "0" },
      uvi: { time: " ", unit: "", value: "0" },
    },
    rainfall: {
      rain_rate: { time: " ", unit: " ", value: "0" },
      daily: { time: " ", unit: " ", value: "0" },
      event: { time: " ", unit: " ", value: "0" },
      hourly: { time: " ", unit: " ", value: "0" },
      weekly: { time: " ", unit: " ", value: "0" },
      monthly: { time: " ", unit: " ", value: "0" },
      yearly: { time: " ", unit: " ", value: "0" },
    },
    wind: {
      wind_speed: { time: " ", unit: " ", value: "0" },
      wind_gust: { time: " ", unit: " ", value: "0" },
      wind_direction: { time: " ", unit: " ", value: "0" },
    },
    pressure: {
      relative: { time: " ", unit: " ", value: "0" },
      absolute: { time: " ", unit: " ", value: "0" },
    },
    battery: { sensor_array: { time: " ", unit: " ", value: "0" } },
  },
});

var loading = ref({ status: true, text: "Loading..." });

var showMoreData = ref(Cookies.get("showMoreData")!=undefined ? Cookies.get("showMoreData") : false);

watch(showMoreData, ()=>{
    Cookies.set("showMoreData", showMoreData.value, { expires: 350 })
  }, { immediate: false })



async function updateData() {
  loading.value = { status: true, text: "Loading..." };
  const res = await fetch(api_url);
  istant_query.value = await res.json();
  console.log(istant_query);
  loading.value = {
    status: false,
    text: `Updated at ${moment(istant_query.value.time * 1000).format(
      "HH:mm"
    )}`,
  };
}



const batteryLevels = ["Normal", "Low"]

watchEffect(async () => {
  updateData();
});


</script>

<template>
  <!--NAVBAR-->
  <div class="navbar bg-base-100">
    <div class="flex-1">
      <a class="btn btn-ghost normal-case text-xl">Mirandola Weather Station</a>
    </div>
    <div class="dropdown dropdown-end">
      <label tabindex="0" class="btn btn-ghost btn-square">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          class="inline-block w-5 h-5 stroke-current"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"
          ></path>
        </svg>
      </label>
      <ul
        tabindex="0"
        class="menu menu-compact dropdown-content p-2 shadow-xl bg-base-100 rounded-box w-36"
      >
        <li>
          <label class="flex-1" for="show-more-data-modal"
            ><img
              class="h-8"
              src="https://img.icons8.com/fluency/administrative-tools.svg"
              alt="settings"
            />
            Settings</label
          >
        </li>
        <li>
          <label class="flex-1" for="show-about-modal"
            ><img
              class="h-8"
              src="https://img.icons8.com/fluency/about.svg"
              alt="about"
            />
            About</label
          >
        </li>
      </ul>
    </div>
  </div>

  <!-- MAIN DATA -->
  <h1 class="text-2xl font-bold m-2 mb-4 bg-base-100 shadow-xl p-5 rounded-xl">
    Istant Data
    <span
      class="btn btn-xs btn-ghost no-animation"
      :class="{ loading: loading.status }"
      >{{ loading.text }}</span
    >
  </h1>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 m-2">
    <!--RAIN-->
    <div class="stats stats-vertical md:stats-horizontal shadow-xl">
      <StatComponent
        title="Current rainfall rate"
        icon="hygrometer"
        :value="istant_query.data.rainfall.rain_rate.value"
        :unit="istant_query.data.rainfall.rain_rate.unit"
        :description="
          'in the last 5 min. <br /> Hourly: ' +
          istant_query.data.rainfall.hourly.value +
          istant_query.data.rainfall.hourly.unit + '<br /> Daily: ' +
          istant_query.data.rainfall.daily.value +
          istant_query.data.rainfall.daily.unit
        "
      />

      <StatComponent
        title="Total rainfall event"
        icon="rain"
        :value="istant_query.data.rainfall.event.value"
        :unit="istant_query.data.rainfall.event.unit"
        :description="
          'Weekly: ' + istant_query.data.rainfall.weekly.value +
          istant_query.data.rainfall.weekly.unit + '<br />Monthly: ' +
          istant_query.data.rainfall.monthly.value +
          istant_query.data.rainfall.monthly.unit + '<br />Yearly: ' +
          istant_query.data.rainfall.yearly.value +
          istant_query.data.rainfall.yearly.unit
        "
      />
    </div>

    <!--OUTDOOR STATS-->
    <div class="stats stats-vertical md:stats-horizontal shadow-xl">
      <StatComponent
        title="Outdoor temperature"
        icon="temperature-outside"
        :value="istant_query.data.outdoor.temperature.value"
        :unit="istant_query.data.outdoor.temperature.unit"
        :description="
          'Dew point: ' +
          istant_query.data.outdoor.dew_point.value +
          istant_query.data.outdoor.dew_point.unit 
        "
        :chart="daily_query.data.outdoor.temperature.list"
      />
      
      <StatComponent
        title="Outdoor humidity"
        icon="barometer-gauge"
        :value="istant_query.data.outdoor.humidity.value"
        :unit="istant_query.data.outdoor.humidity.unit"
        :description="
          'Abs. Pressure: ' +
          istant_query.data.pressure.absolute.value +
          istant_query.data.pressure.absolute.unit 
        "
      />
    
    </div>

    <!--SOLAR AND UVI-->
    <div class="stats stats-vertical md:stats-horizontal shadow-xl">
      
      <StatComponent
        title="Solar Irradiance"
        icon="brightness-settings"
        :value="istant_query.data.solar_and_uvi.solar.value"
        :unit="istant_query.data.solar_and_uvi.solar.unit"
      />
      <StatComponent
        title="UV Index"
        icon="solar-energy"
        :value="istant_query.data.solar_and_uvi.uvi.value"
        :unit="istant_query.data.solar_and_uvi.uvi.unit"
      />

    </div>

    <!--WIND-->
    <div class="stats stats-vertical md:stats-horizontal shadow-xl">
      <StatComponent
        title="Wind speed"
        icon="windsock"
        :value="istant_query.data.wind.wind_speed.value"
        :unit="istant_query.data.wind.wind_speed.unit"
        :description="
        'Wind Gust: ' +
        istant_query.data.wind.wind_gust.value +
        istant_query.data.wind.wind_gust.unit
        "
      />
      
      <StatComponent
        title="Wind speed"
        icon="wind-rose"
        :value="istant_query.data.wind.wind_direction.value"
        :unit="istant_query.data.wind.wind_direction.unit"
      />
     
    </div>
  </div>

   <!-- OTHER DATA -->
  <h1
    class="text-2xl font-bold m-2 mb-4 mt-6 bg-base-100 shadow-xl p-5 rounded-xl"
    v-if="showMoreData"
  >
    Other Stats
    <span
      class="btn btn-xs btn-ghost no-animation"
      :class="{ loading: loading.status }"
      >{{ loading.text }}</span
    >
  </h1>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 m-2" v-if="showMoreData">
    <!--INDOOR STATS-->
    <div class="stats stats-vertical md:stats-horizontal shadow-xl" v-if="showMoreData">
      <StatComponent
        title="Inside temperature"
        icon="temperature-inside"
        :value="istant_query.data.indoor.temperature.value"
        :unit="istant_query.data.indoor.temperature.unit"
        :description="
        'Indoor humidity: ' +
        istant_query.data.indoor.humidity.value +
        istant_query.data.indoor.humidity.unit
        "
      />
      
      <StatComponent
        title="Battery Level"
        icon="medium-battery"
        :value="batteryLevels[parseInt(istant_query.data.battery.sensor_array.value)]"
      />
  </div>
  </div>

  
  <!-- FOOTER AND OTHER DATA -->
  <footer class="footer footer-center mt-10 bg-base-100">
    <div class="text-base-content/40 text-xs">
      <p>
        Developed and designed by
        <a class="font-bold" href="https://jacksalici.com">jacksalici</a
        >.<br />© {{ moment().format("YYYY") }} MIT Licence - Icons by
        <a class="link" href="https://icons8.com/">Icons8</a>
      </p>
    </div>
  </footer>

  <input type="checkbox" id="show-more-data-modal" class="modal-toggle" />
  <label
    for="show-more-data-modal"
    class="modal cursor-pointer modal-bottom sm:modal-middle"
  >
    <label class="modal-box relative">
      <h3 class="font-bold text-lg">Sort of settings</h3>

      <div class="form-control">
        <label class="label cursor-pointer">
          <span class="label-text">Show more data</span>
          <input type="checkbox" class="toggle" v-model="showMoreData" />
        </label>
      </div>
    </label>
  </label>

  <input type="checkbox" id="show-about-modal" class="modal-toggle" />
  <label
    for="show-about-modal"
    class="modal cursor-pointer modal-bottom sm:modal-middle"
  >
    <label class="modal-box relative">
      <h3 class="font-bold text-lg">About</h3>
      <p class="font-sm">
        I didn't have any clue what to write here. If you are a developer check
        the
        <a class="link" href="https://github.com/jacksalici/weather_station"
          >project repo</a
        >.
      </p>
    </label>
  </label>
</template>
